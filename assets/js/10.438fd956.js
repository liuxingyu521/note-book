(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{333:function(s,a,t){"use strict";t.r(a);var n=t(33),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"babel"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#babel"}},[s._v("#")]),s._v(" babel")]),s._v(" "),t("p",[t("code",[s._v("Babel")]),s._v(" 是一个转换 ECMAScript 2015+ 的工具链，把高级语法转换成目标环境可用的代码。")]),s._v(" "),t("p",[t("code",[s._v("Babel")]),s._v(" 本身不对代码做任何转换，即 "),t("code",[s._v("const babel = code => code;")]),s._v("，需要配合 babel 插件（"),t("code",[s._v("plugins")]),s._v(" or "),t("code",[s._v("presets")]),s._v("）对代码做转换。")]),s._v(" "),t("h2",{attrs:{id:"名词解释"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#名词解释"}},[s._v("#")]),s._v(" 名词解释")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("plugins")]),s._v(" ： 插件，对代码做转换的插件工具。（配置中为数组类型，按照数组顺序依次执行）")]),s._v(" "),t("li",[t("strong",[s._v("presets")]),s._v(" ： 预设，是一组插件的集合。（配置中为数组类型，按照数组顺序 "),t("strong",[s._v("逆序")]),s._v(" 执行）")]),s._v(" "),t("li",[t("strong",[s._v("polyfill")]),s._v(" ： 对一些目标环境没有的特性做兼容处理的等价代码。")])]),s._v(" "),t("h2",{attrs:{id:"基本使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本使用"}},[s._v("#")]),s._v(" 基本使用")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("安装工具库和预设环境，以及对目标环境缺失的特性做 polyfill 的文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 工具库")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --save-dev @babel/core @babel/cli @babel/preset-env\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 代码 polyfill")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --save @babel/polyfill\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("创建配置文件（"),t("code",[s._v("babel.config.json")]),s._v(" or "),t("code",[s._v(".babelrc.json")]),s._v("，具体区别见下方 "),t("a",{attrs:{href:"#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"}},[s._v("配置文件命名区别")]),s._v("）")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"presets"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@babel/env"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])]),s._v(" "),t("li",[t("p",[s._v("可使用命令行对代码进行转换")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ npx babel src --out-dir lib\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])]),s._v(" "),t("h2",{attrs:{id:"配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置文件"}},[s._v("#")]),s._v(" 配置文件")]),s._v(" "),t("p",[s._v("在 "),t("code",[s._v("babel")]),s._v(" 中，处理代码转换全部依靠插件配置，一个配置例子如下")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// babel config function 参见：https://babeljs.io/docs/en/config-files#config-function-api")]),s._v("\nmodule"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("exports")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("api")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 此配置只会动态计算一次，导出静态对象给 babel 使用")]),s._v("\n  api"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cache")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 预设 => 一些转换插件的集合")]),s._v("\n    presets"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@babel/env'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 仅转译代码里使用的浏览器支持的新特性，其他特性需要额外安装 plugins")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          useBuiltIns"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'usage'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在代码中使用到环境中没有的特性时，自动载入需要的 polyfill 代码")]),s._v("\n          corejs"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            version"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            proposals"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 所有建议的特性都用 corejs 的代码来polyfill")]),s._v("\n          "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 单独配置插件")]),s._v("\n    plugins"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将每个文件里用到的公共方法函数，都从 @babel/runtime 里导出，")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 去掉每个文件的重复函数，减少打包体积")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'@babel/plugin-transform-runtime'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("h3",{attrs:{id:"配置文件命名区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置文件命名区别"}},[s._v("#")]),s._v(" 配置文件命名区别")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("babel.config.json")]),s._v(" or "),t("code",[s._v(".babelrc.json")]),s._v(": 使用 "),t("code",[s._v("JSON5")]),s._v(" 解析，json 格式的进阶版，可注释")]),s._v(" "),t("li",[t("code",[s._v("babel.config.cjs")]),s._v(": 文件格式为 "),t("code",[s._v("commonjs")]),s._v(" 语法，配置使用 "),t("code",[s._v("module.exports = {}")]),s._v(" 导出")]),s._v(" "),t("li",[t("code",[s._v("babel.config.mjs")]),s._v(": 文件格式为 "),t("code",[s._v("ECMAScript modules")]),s._v(" 的语法，使用 "),t("code",[s._v("export")]),s._v(" 导出")]),s._v(" "),t("li",[t("code",[s._v("babel.config.js")]),s._v(": 如果 babel 配置里声明了 "),t("code",[s._v("type: module")]),s._v("，和 "),t("code",[s._v("babel.config..mjs")]),s._v(" 行为一样，否则和 "),t("code",[s._v("babel.config.cjs")]),s._v(" 行为一致，使用 "),t("code",[s._v("mocule.exports = {}")]),s._v(" 导出")])]),s._v(" "),t("h2",{attrs:{id:"一些配置插件的理解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一些配置插件的理解"}},[s._v("#")]),s._v(" 一些配置插件的理解")]),s._v(" "),t("p",[s._v("在 babel 中有很多的插件，很容易混淆，不知道哪个该引哪个不该引，接下来分享下这些插件的作用。")]),s._v(" "),t("h3",{attrs:{id:"babel-polyfill"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#babel-polyfill"}},[s._v("#")]),s._v(" @babel/polyfill")]),s._v(" "),t("p",[s._v("这个插件用来模拟全部 es2015+ 的特性环境，会在全局原型上增加 polyfill。")]),s._v(" "),t("p",[t("strong",[s._v("注意：")]),s._v(" 在 babel 7.4.0 之后，已自动集成 "),t("code",[s._v("core-js/stable")]),s._v("(对 ECMAScript 特性做 polyfill) 和 "),t("code",[s._v("regenerator-runtime/runtime")]),s._v("(转换 generator 函数)。不需要单独引入 "),t("code",[s._v("@babel/polyfill")])]),s._v(" "),t("h3",{attrs:{id:"transform-runtime"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#transform-runtime"}},[s._v("#")]),s._v(" transform-runtime")]),s._v(" "),t("p",[s._v("转换运行时使用 "),t("code",[s._v("@babel/runtime")]),s._v(" 中的 helper 函数来替代每个文件中使用的公共函数，比如 "),t("code",[s._v("_createClass")]),s._v("、"),t("code",[s._v("_inherits")]),s._v("，使得每个文件没有重复函数实现，减少打包体积。")]),s._v(" "),t("p",[s._v("转换运行时需要 2 个插件支持，"),t("code",[s._v("@babel/plugin-transform-runtime")]),s._v(" 和 "),t("code",[s._v("@babel/runtime")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# devDependencies 依赖，用来把每个文件用到的公共函数从 `@babel/runtime` 中导出")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -D @babel/plugin-transform-runtime\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装实际引用的公共代码，会被打包在最终文件中")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" --save @babel/runtime\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);